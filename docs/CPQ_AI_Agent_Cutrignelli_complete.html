<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPQ AI Agent - Query-Centric RAG System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            overflow: hidden;
        }
        
        .presentation-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            gap: 20px; /* Space between slides and controls */
        }

        .slides-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-height: calc(100vh - 80px); /* Reserve 80px for controls + padding */
        }
        
        .slide {
            /* Calculate max dimensions that fit in available space */
            width: min(90vw, calc((100vh - 100px) * 1.777)); /* 16:9 width, accounting for controls */
            height: min(50.625vw, calc(100vh - 100px)); /* 16:9 height, accounting for controls */
            background: white;
            border-radius: 15px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            display: none;
            position: relative;
            overflow: hidden;
        }
        
        .slide.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 40px;
            position: relative;
        }
        
        .slide-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
        }
        
        .slide-title {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .slide-subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .slide-content {
            padding: 40px;
            height: calc(100% - 140px);
            overflow-y: auto;
        }
        
        .slide-counter {
            position: absolute;
            top: 35px;
            right: 40px;
            background: rgba(255,255,255,0.9);
            color: #333;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            z-index: 100;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            /* height: 100%; */
        }
        
        .three-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
        }
        
        .four-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 20px;
        }
        
        .component-box {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            padding: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .component-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .component-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #495057;
            margin-bottom: 15px;
        }
        
        .component-list {
            list-style: none;
            padding: 0;
        }
        
        .component-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            color: #6c757d;
        }
        
        .component-list li:last-child {
            border-bottom: none;
        }
               
        .flow-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 15px 0;
        }
        
        .flow-step {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            flex: 1;
            margin: 0 10px;
        }
        
        .arrow {
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
        }
        
        .highlight {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        
        .highlight-bottom {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
            margin: 30px 0 20px 0;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
            clear: both;
            position: relative;
            z-index: 10;
        }

        .flow-container {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .flow-container-minimal {
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .architecture-diagram {
            /* background: linear-gradient(145deg, #ffffff, #f8f9fa); */
            border-radius: 15px;
            /* padding: 30px; */
            margin: 0 0 20px 0;
            /* box-shadow: 0 5px 15px rgba(0,0,0,0.1); */
        }
        
        .layer-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(78, 205, 196, 0.3);
        }

        .layer-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin: 20px 0;
        }
        
        .stat-box {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #4ecdc4;
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1.1em;
            color: #6c757d;
            font-weight: 600;
        }
        
        .objectives-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            height: 100%;
        }
        
        .objective-section {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .objective-section.objectives {
            border-left: 5px solid #28a745;
        }
        
        .objective-section.non-objectives {
            border-left: 5px solid #dc3545;
        }
        
        .objective-title {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .objectives .objective-title {
            color: #28a745;
        }
        
        .non-objectives .objective-title {
            color: #dc3545;
        }
        
        .objective-list {
            list-style: none;
            padding: 0;
        }
        
        .objective-list li {
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
            position: relative;
            padding-left: 25px;
        }
        
        .objective-list li:before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }
        
        .non-objectives .objective-list li:before {
            content: '✗';
            color: #dc3545;
        }
        
        .objective-list li:last-child {
            border-bottom: none;
        }
        
        .deliverables-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin: 20px 0;
        }
        
        .deliverable-box {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }
        
        .deliverable-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #495057;
            margin-bottom: 15px;
        }
        
        .deliverable-list {
            list-style: none;
            padding: 0;
        }
        
        .deliverable-list li {
            padding: 8px 0;
            color: #6c757d;
            position: relative;
            padding-left: 20px;
        }
        
        .deliverable-list li:before {
            content: '→';
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }
        
        .problem-solution {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .problem-box, .solution-box {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .problem-box {
            border-left: 5px solid #dc3545;
        }
        
        .solution-box {
            border-left: 5px solid #28a745;
        }
        
        .section-title {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .problem-box .section-title {
            color: #dc3545;
        }
        
        .solution-box .section-title {
            color: #28a745;
        }
        
        .section-content {
            color: #495057;
            line-height: 1.6;
        }
        
        .section-content ul {
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .section-content li {
            margin: 8px 0;
        }
        
        /* Chat Demo Styles */
        .chat-container {
            background: #f8f9fa;
            border-radius: 15px;
            height: 90%;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-title {
            font-size: 1.3em;
            font-weight: 700;
        }
        
        .chat-status {
            background: #28a745;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: white;
        }
        
        .chat-message {
            margin: 15px 0;
            padding: 15px 20px;
            border-radius: 18px;
            /* max-width: 80%; */
            line-height: 1.5;
            animation: messageSlide 0.5s ease-out;
        }
        
        @keyframes messageSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .chat-message.agent {
            background: linear-gradient(145deg, #e9ecef, #f8f9fa);
            color: #495057;
            border-bottom-left-radius: 5px;
            border-left: 4px solid #4ecdc4;
            max-width: 80%;
        }

        .chat-message.user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            max-width: fit-content;
            min-width: 120px;
            margin-left: auto;
            margin-right: 0;
            border-bottom-right-radius: 5px;
            text-align: right;
        }

        .typing-cursor {
            display: inline-block;
            background-color: currentColor;
            width: 2px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .streaming-content {
            display: inline;
        }

        .streaming-block {
            opacity: 0;
            animation: fadeInBlock 0.1s ease-out forwards;
        }

        @keyframes fadeInBlock {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Thinking dots animation */
        .thinking-indicator {
            margin: 15px 0;
            padding: 15px 20px;
            border-radius: 18px;
            max-width: 80%;
            border-bottom-left-radius: 5px;
            border-left: 4px solid #4ecdc4;
            background: linear-gradient(145deg, #e9ecef, #f8f9fa);
            animation: messageSlide 0.5s ease-out;
        }

        .thinking-dots {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .thinking-dot {
            width: 8px;
            height: 8px;
            background-color: #6c757d;
            border-radius: 50%;
            animation: thinkingBounce 1.4s infinite ease-in-out;
        }

        .thinking-dot:nth-child(1) { animation-delay: -0.32s; }
        .thinking-dot:nth-child(2) { animation-delay: -0.16s; }
        .thinking-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes thinkingBounce {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        /* Markdown styling for agent messages */
        .agent-content h1, .agent-content h2, .agent-content h3 {
            color: #495057;
            margin: 8px 0 4px 0;
            font-weight: 700;
            line-height: 1.2;
        }

        .agent-content h1 { font-size: 1.4em; }
        .agent-content h2 { font-size: 1.3em; }
        .agent-content h3 { font-size: 1.2em; }

        .agent-content ul {
            margin: 4px 0;
            padding-left: 20px;
            line-height: 1.3;
        }

        .agent-content li {
            margin: 2px 0;
            color: #6c757d;
            line-height: 1.3;
        }

        .agent-content p {
            margin: 4px 0;
            line-height: 1.4;
        }

        /* Tighter spacing for chat content overall */
        .agent-content {
            line-height: 1.4;
        }

        .user-content {
            line-height: 1.4;
        }

        .agent-content strong {
            color: #495057;
            font-weight: 600;
        }

        .agent-content code {
            background: rgba(102, 126, 234, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .chat-controls {
            padding: 20px;
            background: #f8f9fa;
            display: flex;
            gap: 15px;
            justify-content: center;
            border-top: 1px solid #e9ecef;
        }
        
        .chat-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }
        
        .chat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .chat-btn.btn-hidden {
            display: none;
        }
        
        .chat-btn.btn-visible {
            display: inline-block;
        }
        
        .demo-placeholder {
            text-align: center;
            color: #6c757d;
            font-size: 1.1em;
            padding: 50px;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            border: 2px dashed #dee2e6;
        }
        
        .controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.1);
            padding: 10px 20px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }

        .control-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }

        .control-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        /* Commercial Offer Styles */
        .commercial-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .proposal-section {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .my-proposal {
            border-left: 5px solid #28a745;
        }
        
        .external-proposal {
            border-left: 5px solid #dc3545;
        }
        
        .proposal-title {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .my-proposal .proposal-title {
            color: #28a745;
        }
        
        .external-proposal .proposal-title {
            color: #dc3545;
        }
        
        .comparison-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .comparison-stat {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .comparison-number {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .my-proposal .comparison-number {
            color: #28a745;
        }
        
        .external-proposal .comparison-number {
            color: #dc3545;
        }
        
        .comparison-label {
            font-size: 0.9em;
            color: #6c757d;
            font-weight: 600;
        }
        
        .roi-analysis {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
            margin: 20px 0;
        }
        
        .roi-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .roi-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .roi-stat {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .roi-number {
            font-size: 2em;
            font-weight: 700;
            color: #28a745;
            margin-bottom: 8px;
        }
        
        .roi-label {
            font-size: 1em;
            color: #6c757d;
            font-weight: 600;
        }

        .workflow-image {
            /* background: linear-gradient(145deg, #ffffff, #f8f9fa); */
            border-radius: 12px;
            /* padding: 20px; */
            /* box-shadow: 0 5px 15px rgba(0,0,0,0.1); */
            margin: 0 0 20px 0;
        }

        .workflow-image img {
            display: block;
            margin: 0 auto;
            max-width: 100%;
            height: auto;
        }

        /* Full Title Slide */
        .title-slide-full {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .title-slide-full::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255,255,255,0.1) 50%, 
                transparent 70%);
            animation: shimmer 6s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .title-content-center {
            text-align: center;
            color: white;
            z-index: 10;
            position: relative;
            animation: fadeInScale 1.5s ease-out;
        }

        @keyframes fadeInScale {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(30px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .title-main {
            font-size: 4.5em;
            font-weight: 900;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            background: linear-gradient(45deg, #fff, #e0e7ff, #fff);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: textGlow 3s ease-in-out infinite;
        }

        @keyframes textGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .title-sub {
            font-size: 1.6em;
            font-weight: 300;
            margin-bottom: 15px;
            opacity: 0.95;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        .title-version {
            font-size: 1.2em;
            font-weight: 400;
            margin-bottom: 60px;
            opacity: 0.85;
            padding: 12px 30px;
            background: rgba(255,255,255,0.15);
            border-radius: 25px;
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            animation: fadeInUp 1s ease-out 0.7s both;
        }

        .author-info {
            margin-top: 80px;
            padding-top: 40px;
            border-top: 2px solid rgba(255,255,255,0.3);
            animation: fadeInUp 1s ease-out 1s both;
        }

        .author-name {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        }

        .author-title {
            font-size: 1.2em;
            font-weight: 400;
            opacity: 0.9;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Enhanced Thank You Slide with Dynamic Animation */
        .thank-you-slide-full {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .thank-you-slide-full::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255,255,255,0.1) 50%, 
                transparent 70%);
            animation: shimmer 8s ease-in-out infinite;
        }

        .thank-you-slide-full::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 107, 107, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(78, 205, 196, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(69, 183, 209, 0.2) 0%, transparent 50%);
            animation: floatParticles 12s ease-in-out infinite;
        }

        @keyframes floatParticles {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg); 
                opacity: 0.6;
            }
            50% { 
                transform: translateY(-30px) rotate(180deg); 
                opacity: 0.8;
            }
        }

        .thank-you-content-center {
            text-align: center;
            color: white;
            z-index: 10;
            position: relative;
            animation: fadeInScale 2s ease-out;
        }

        .thank-you-main-title {
            font-size: 4.8em;
            font-weight: 900;
            margin-bottom: 25px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            background: linear-gradient(45deg, #fff, #e0e7ff, #fff);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: textGlow 4s ease-in-out infinite;
        }

        .thank-you-subtitle {
            font-size: 1.8em;
            font-weight: 300;
            margin-bottom: 20px;
            opacity: 0.95;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        .thank-you-contact {
            font-size: 1.3em;
            font-weight: 400;
            margin-bottom: 80px;
            opacity: 0.85;
            padding: 15px 35px;
            background: rgba(255,255,255,0.15);
            border-radius: 30px;
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            animation: fadeInUp 1s ease-out 0.8s both;
        }

        .thank-you-author {
            margin-top: 60px;
            padding-top: 40px;
            border-top: 2px solid rgba(255,255,255,0.3);
            animation: fadeInUp 1s ease-out 1.2s both;
        }

        .thank-you-author-name {
            font-size: 1.9em;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        }

        .thank-you-author-title {
            font-size: 1.3em;
            font-weight: 400;
            opacity: 0.9;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <div class="slides-area">
        
            <!-- Slide: Title Slide -->
            <div class="slide active title-slide">
                <div class="title-slide-full">
                    <div class="title-content-center">
                        <div class="title-main">CPQ AI Agent</div>
                        <div class="title-sub">Query-Centric RAG System for Enterprise Sales Automation</div>
                        <div class="title-version">Enhanced for n8n Integration</div>
                        
                        <div class="author-info">
                            <div class="author-name">Giancarlo Cutrignelli</div>
                            <div class="author-title"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: Problem & Solution -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Problem & Solution</div>
                    <div class="slide-subtitle">Enterprise CPQ Process Automation Challenge</div>
                </div>
                <div class="slide-content">
                    <div class="problem-solution">
                        <div class="problem-box">
                            <div class="section-title">🎯 Problem to Solve</div>
                            <div class="section-content">
                                <p><strong>Challenge:</strong> Improve quality and response time for customer quote requests without generating additional workload and burden on the organization, especially Product Management.</p>
                                
                                <ul>
                                    <li><strong>Manual CPQ Process:</strong> Time-intensive quote generation</li>
                                    <li><strong>Resource Constraints:</strong> Limited Product Management bandwidth</li>
                                    <li><strong>Inconsistent Quality:</strong> Variable quote accuracy and completeness</li>
                                    <li><strong>Slow Response Times:</strong> Extended customer wait times</li>
                                    <li><strong>Scalability Issues:</strong> Process doesn't scale with business growth</li>
                                </ul>
                            </div>
                        </div>
                        <div class="solution-box">
                            <div class="section-title">💡 Solution</div>
                            <div class="section-content">
                                <p><strong>Conversational RAG-driven AI Agent</strong> managing the complete CPQ (Configure-Price-Quote) sales process</p>
                                
                                <ul>
                                    <li><strong>Automated Configuration:</strong> AI-guided product selection</li>
                                    <li><strong>Intelligent Pricing:</strong> Dynamic pricing with market factors</li>
                                    <li><strong>Query-Centric RAG:</strong> Knowledge-driven responses</li>
                                    <li><strong>Enterprise Integration:</strong> Full n8n workflow automation</li>
                                    <li><strong>Zero PM Overhead:</strong> Self-service quote generation</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="highlight-bottom">
                        Enterprise-grade AI solution delivering automated CPQ processes with zero additional organizational burden
                    </div>
                </div>
            </div>

            <!-- Slide: Solution Overview -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Query-Centric RAG Solution</div>
                    <div class="slide-subtitle">Enterprise CPQ Automation with Conversational Intelligence</div>
                </div>
                <div class="slide-content">
                    <div class="highlight">
                        Revolutionary approach: Natural language queries automatically mapped to business functions
                    </div>
                    <div class="flow-container">
                        <div class="flow-row">
                            <span class="flow-step">Natural Language Input</span>
                            <span class="arrow">→</span>
                            <span class="flow-step">Intent Recognition</span>
                            <span class="arrow">→</span>
                            <span class="flow-step">Function Execution</span>
                            <span class="arrow">→</span>
                            <span class="flow-step">Customer Quote</span>
                        </div>
                    </div>
                    <div class="three-column">
                        <div class="component-box">
                            <div class="component-title">Query Intelligence</div>
                            <ul class="component-list">
                                <li>37 Verified Operations (Q000-Q036)</li>
                                <li>Intent classification engine</li>
                                <li>Context-aware processing</li>
                                <li>Multi-turn conversation support</li>
                            </ul>
                        </div>
                        <div class="component-box">
                            <div class="component-title">Business Logic</div>
                            <ul class="component-list">
                                <li>150+ PostgreSQL Functions</li>
                                <li>Configuration validation rules</li>
                                <li>Multi-market pricing models</li>
                                <li>Automated ordering resolution</li>
                            </ul>
                        </div>
                        <div class="component-box">
                            <div class="component-title">Enterprise Integration</div>
                            <ul class="component-list">
                                <li>n8n workflow orchestration</li>
                                <li>6 specialized CPQ tools</li>
                                <li>PGVector semantic search</li>
                                <li>Session state management</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: Live Conversation Demo -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Live Conversation Demo</div>
                    <div class="slide-subtitle">Actual CPQ Agent Interaction</div>
                </div>
                <div class="slide-content">
                    <div class="chat-container">
                        <div class="chat-header">
                            <div class="chat-title">CPQ AI Agent</div>
                            <div class="chat-status">● Live Session</div>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="demo-placeholder">
                                🎬 Click a button below to start the interactive demo
                            </div>
                        </div>
                        <div class="chat-controls">
                            <button class="chat-btn btn-visible" id="playBtn">▶ Play Demo</button>
                            <button class="chat-btn btn-visible" id="stepBtn">👆 Step Mode</button>
                            <button class="chat-btn btn-hidden" id="nextBtn">Next →</button>
                            <button class="chat-btn btn-visible" id="resetBtn">⟲ Reset</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: System Overview -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">System Architecture Overview</div>
                    <div class="slide-subtitle">Enterprise CPQ Solution: Product Database + Business Logic + AI Agent</div>
                </div>
                <div class="slide-content">
                    <div class="highlight">
                        Enterprise CPQ Solution: Product Database + Business Logic + AI Agent
                    </div>
                    <div class="flow-container">
                        <div class="flow-row">
                            <span class="flow-step">Product Database</span>
                            <span class="arrow">→</span>
                            <span class="flow-step">Business Functions</span>
                            <span class="arrow">→</span>
                            <span class="flow-step">RAG AI Agent</span>
                            <span class="arrow">→</span>
                            <span class="flow-step">Customer Quote</span>
                        </div>
                    </div>
                    <div class="three-column">
                        <div class="component-box">
                            <div class="component-title">Data Layer</div>
                            <ul class="component-list">
                                <li>Hardware Products</li>
                                <li>Software Bundles</li>
                                <li>Service Catalog</li>
                                <li>Pricing Models</li>
                            </ul>
                        </div>
                        <div class="component-box">
                            <div class="component-title">Logic Layer</div>
                            <ul class="component-list">
                                <li>Configuration Rules</li>
                                <li>Pricing Calculations</li>
                                <li>Validation Functions</li>
                                <li>Quote Generation</li>
                            </ul>
                        </div>
                        <div class="component-box">
                            <div class="component-title">AI Layer</div>
                            <ul class="component-list">
                                <li>Query-Centric RAG</li>
                                <li>Intent Recognition</li>
                                <li>Function Mapping</li>
                                <li>Context Management</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: Query-Centric RAG Architecture -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Query-Centric RAG Architecture</div>
                    <div class="slide-subtitle">Intent-Driven Function Mapping with Knowledge Intelligence</div>
                </div>
                <div class="slide-content">
                    <div class="architecture-diagram">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #495057;">RAG Knowledge Architecture</h3>
                        <div class="flow-container-minimal">
                            <div class="layer-box">Query Registry (37 Operations)</div>
                            <div class="layer-box">Function Intelligence (150+ Business Functions)</div>
                            <div class="layer-box">Conversation Patterns (Intent Classification)</div>
                            <div class="layer-box">PGVector Store (Semantic Search)</div>
                            <div class="layer-box">Context-Aware Response Generation</div>
                        </div>
                    </div>
                    <div class="two-column">
                        <div>
                            <h3 style="color: #667eea; margin-bottom: 20px;">Intent-Based Query Processing</h3>
                            <div class="component-box">
                                <div class="component-title">Discovery & Configuration</div>
                                <ul class="component-list">
                                    <li>Q001: Product Family Discovery</li>
                                    <li>Q003: Hardware Options</li>
                                    <li>Q005: Hardware Selection</li>
                                    <li>Q006: Component Options</li>
                                    <li>Q008: Component Addition</li>
                                    <li>Q015: Software Bundle Selection</li>
                                    <li>Q018: Service Discovery</li>
                                    <li>Q019: Service Addition</li>
                                </ul>
                            </div>
                            <div class="component-box">
                                <div class="component-title">Pricing & Quote Operations</div>
                                <ul class="component-list">
                                    <li>Q026: Pricing Calculation</li>
                                    <li>Q027: Yearly Summary</li>
                                    <li>Q028: Item Summary</li>
                                    <li>Q029: Quote Generation</li>
                                    <li>Q030: Ordering Context</li>
                                    <li>Q035: Quote Details</li>
                                    <li>Q036: Business Case Analysis</li>
                                </ul>
                            </div>
                        </div>
                        <div>
                            <h3 style="color: #667eea; margin-bottom: 20px;">Knowledge Base Categories</h3>
                            <div class="component-box">
                                <div class="component-title">Query Registry</div>
                                <ul class="component-list">
                                    <li>37 Verified Operations (Q000-Q036)</li>
                                    <li>Natural Language Mapping</li>
                                    <li>Function Parameter Extraction</li>
                                    <li>Intent Classification Rules</li>
                                </ul>
                            </div>
                            <div class="component-box">
                                <div class="component-title">Function Intelligence</div>
                                <ul class="component-list">
                                    <li>150+ PostgreSQL Functions</li>
                                    <li>Parameter Validation Logic</li>
                                    <li>Error Handling Patterns</li>
                                    <li>Business Rule Documentation</li>
                                </ul>
                            </div>
                            <div class="component-box">
                                <div class="component-title">Conversation Patterns</div>
                                <ul class="component-list">
                                    <li>Intent Recognition Patterns</li>
                                    <li>Error Recovery Flows</li>
                                    <li>Context Management Rules</li>
                                    <li>Natural Language Templates</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: RAG Knowledge Builder Workflow -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">RAG Knowledge Builder Workflow</div>
                    <div class="slide-subtitle">Automated Knowledge Base Construction</div>
                </div>
                <div class="slide-content">
                    <div class="workflow-image">
                        <img src="./images/RAG_Knowledge_Builder_Workflow.jpg" 
                            style="width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" 
                            alt="RAG Knowledge Builder Workflow"/>
                    </div>
                    <div class="workflow-description">
                        <div class="two-column">
                            <div class="component-box">
                                <div class="component-title">Data Sources</div>
                                <ul class="component-list">
                                    <li>Query registry tables</li>
                                    <li>Business function definitions</li>
                                    <li>Product catalog files</li>
                                    <li>Conversation intelligence patterns</li>
                                    <li>Market-specific requirements</li>
                                </ul>
                            </div>
                            <div class="component-box">
                                <div class="component-title">Processing Features</div>
                                <ul class="component-list">
                                    <li>Tag extraction and categorization</li>
                                    <li>Document embeddings generation</li>
                                    <li>Vector store optimization</li>
                                    <li>Knowledge validation and testing</li>
                                    <li>Automated knowledge updates</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: CPQ AI Agent Workflow -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">CPQ AI Agent Workflow</div>
                    <div class="slide-subtitle">n8n Integration Architecture</div>
                </div>
                <div class="slide-content">
                    <div class="workflow-image">
                        <img src="./images/CPQ_AI_Agent_Workflow.jpg" 
                            style="width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" 
                            alt="CPQ AI Agent Workflow"/>
                    </div>
                    <div class="workflow-description">
                        <div class="two-column">
                            <div class="component-box">
                                <div class="component-title">Key Components</div>
                                <ul class="component-list">
                                    <li>Session Manager with RAG validation</li>
                                    <li>PostgreSQL RAG retrieval system</li>
                                    <li>OpenRouter chat model integration</li>
                                    <li>8 specialized CPQ tools</li>
                                    <li>Google Gemini embeddings</li>
                                </ul>
                            </div>
                            <div class="component-box">
                                <div class="component-title">Key Features</div>
                                <ul class="component-list">
                                    <li>Real-time conversation processing</li>
                                    <li>Context-aware responses</li>
                                    <li>Automated error handling</li>
                                    <li>Session state persistence</li>
                                    <li>Multi-tool orchestration</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Slide: Technical Implementation -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">n8n Integration & Technology Stack</div>
                    <div class="slide-subtitle">Complete Enterprise Integration Architecture</div>
                </div>
                <div class="slide-content">
                    <div class="architecture-diagram">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #495057;">System Integration Layers</h3>
                        <div class="flow-container">
                            <div class="layer-box">AI Agent (LangChain + DeepSeek Chat Model)</div>
                            <div class="layer-box">Query-Centric RAG (Google Gemini + PGVector Store)</div>
                            <div class="layer-box">n8n Workflow Orchestration (Business Process Automation)</div>
                            <div class="layer-box">Specialized CPQ Tools (Domain-Specific Logic)</div>
                            <div class="layer-box">PostgreSQL Database (Product & Business Data)</div>
                        </div>
                    </div>
                    <div class="table-container">
                        <h3 style="margin-bottom: 15px; color: #495057;">CPQ Tool Suite</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Tool Name</th>
                                    <th>Operations</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Session Manager</strong></td>
                                    <td>create_session, get_status</td>
                                    <td>Session lifecycle & state management</td>
                                </tr>
                                <tr>
                                    <td><strong>Agent Memory</strong></td>
                                    <td>store_context, retrieve_context, update_memory</td>
                                    <td>Conversation context & session memory</td>
                                </tr>
                                <tr>
                                    <td><strong>CPQ Hardware Tool</strong></td>
                                    <td>product_families, hardware_options, configurations</td>
                                    <td>Hardware discovery & selection</td>
                                </tr>
                                <tr>
                                    <td><strong>CPQ Software Tool</strong></td>
                                    <td>software_bundles, individual_software, validation</td>
                                    <td>Software configuration & bundling</td>
                                </tr>
                                <tr>
                                    <td><strong>CPQ Pricing Tool</strong></td>
                                    <td>calculate_pricing, yearly_summary, business_case</td>
                                    <td>Pricing calculation & financial analysis</td>
                                </tr>
                                <tr>
                                    <td><strong>CPQ Quote Tool</strong></td>
                                    <td>generate_quote, ordering_codes, validation</td>
                                    <td>Quote generation & ordering</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Slide: Complexity Statistics -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Product Portfolio & Database Complexity</div>
                    <div class="slide-subtitle">Enterprise-Scale Data Model & Development Metrics</div>
                </div>
                <div class="slide-content">
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-number">18</div>
                            <div class="stat-label">Hardware Product Families</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">55+</div>
                            <div class="stat-label">Standard Product Configurations</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">150+</div>
                            <div class="stat-label">Hardware Components</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">40+</div>
                            <div class="stat-label">Software Bundles & Individual Packages</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">15+</div>
                            <div class="stat-label">Professional Service Products</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">40+</div>
                            <div class="stat-label">Database Tables</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">150+</div>
                            <div class="stat-label">PostgreSQL Business Functions</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">37</div>
                            <div class="stat-label">Verified Query-Centric RAG Operations</div>
                        </div>
                    </div>
                    <div class="single-column">
                        <div class="component-box">
                            <div class="component-title">Development Effort Summary</div>
                            <ul class="component-list">
                                <li><strong>CPQ Database:</strong> 8+ weeks development & testing (including configurable test scenario script)</li>
                                <li><strong>AI Agent:</strong> 6+ weeks query-centric RAG implementation (different architectures experimented)</li>
                                <li><strong>n8n Integration:</strong> 4+ weeks workflow and tool development</li>
                                <li><strong>n8n version compatibility fixes:</strong> 3+ weeks migration to latest version</li>
                                <li><strong>Total Investment:</strong> 20+ weeks enterprise development</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide: Project Deliverables -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Project Deliverables</div>
                    <div class="slide-subtitle">Complete Enterprise CPQ AI Agent Solution</div>
                </div>
                <div class="slide-content">
                    <div class="deliverables-grid">
                        <div class="deliverable-box">
                            <div class="deliverable-title">🤖 AI Agent System</div>
                            <ul class="deliverable-list">
                                <li>Query-Centric RAG AI Agent</li>
                                <li>37 Verified Query Operations (Q000-Q036)</li>
                                <li>Intent Recognition & Function Mapping</li>
                                <li>Context Management & Session Handling</li>
                                <li>n8n Compatible Workflows</li>
                            </ul>
                        </div>
                        <div class="deliverable-box">
                            <div class="deliverable-title">🗄️ Enterprise Database</div>
                            <ul class="deliverable-list">
                                <li>Complete Product Catalog</li>
                                <li>150+ Business Logic Functions</li>
                                <li>Multi-Market Pricing Models</li>
                                <li>Configuration Validation Rules</li>
                                <li>Hardware-Software Compatibility Matrix</li>
                            </ul>
                        </div>
                        <div class="deliverable-box">
                            <div class="deliverable-title">🔧 Integration Tools</div>
                            <ul class="deliverable-list">
                                <li>6 Specialized CPQ Tools</li>
                                <li>PGVector Knowledge Base</li>
                                <li>Workflow Orchestration</li>
                                <li>Error Handling & Recovery</li>
                                <li>Business Process Automation</li>
                            </ul>
                        </div>
                        <div class="deliverable-box">
                            <div class="deliverable-title">📈 Business Value</div>
                            <ul class="deliverable-list">
                                <li>Automated Quote Generation</li>
                                <li>Multi-Year Volume Pricing</li>
                                <li>Configuration Validation</li>
                                <li>Ordering Code Resolution</li>
                                <li>Technical Sales Acceleration</li>
                            </ul>
                        </div>
                    </div>
                    <div class="highlight">
                        Complete enterprise CPQ solution combining AI intelligence with robust business processes for scalable technical sales automation
                    </div>
                </div>
            </div>

            <!-- Slide: Value Assessment & Consultant Cost Analysis -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Value Assessment & Consultant Cost Analysis</div>
                    <div class="slide-subtitle">What is this ready-to-deploy solution worth to you?</div>
                </div>
                <div class="slide-content">
                    <div class="commercial-comparison">
                        <div class="proposal-section my-proposal">
                            <div class="proposal-title">💡 Value Question</div>
                            <div style="text-align: center; padding: 40px 20px;">
                                <div style="font-size: 2.2em; font-weight: 700; color: #667eea; margin-bottom: 20px;">
                                    How much is this tool worth for you?
                                </div>
                                <div style="font-size: 1.2em; color: #6c757d; line-height: 1.6;">
                                    Consider the alternative costs below and determine the value of having a ready-to-deploy CPQ AI Agent solution available immediately.
                                </div>
                            </div>
                            <ul class="component-list">
                                <li><strong>Immediate Deployment:</strong> Zero development time required</li>
                                <li><strong>Proven Solution:</strong> 20+ weeks of development already invested</li>
                                <li><strong>Fixed Scope:</strong> Complete feature set with no unknowns</li>
                                <li><strong>Start Saving Today:</strong> Begin ROI from day 1</li>
                            </ul>
                        </div>
                        <div class="proposal-section external-proposal">
                            <div class="proposal-title">⏳ External Consultant Alternative</div>
                            <div class="comparison-stats">
                                <div class="comparison-stat">
                                    <div class="comparison-number">€208,000</div>
                                    <div class="comparison-label">Development Cost (6 man-months at €200/hour)</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€6,000</div>
                                    <div class="comparison-label">Internal Support (4 hours/week × 6 months)</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">12 months</div>
                                    <div class="comparison-label">Time to Deployment</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€32,000</div>
                                    <div class="comparison-label">Lost savings: 50% of Junior PM annual salary</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€246,000</div>
                                    <div class="comparison-label">Total Cost + Lost Savings (€32k in 12 months)</div>
                                </div>
                            </div>                            
                            <ul class="component-list">
                                <li><strong>High Development Risk:</strong> Scope creep and timeline delays</li>
                                <li><strong>Internal Resource Drain:</strong> 4 hours/week for 6 months</li>
                                <li><strong>Delayed Value:</strong> 12 months before any savings begin</li>
                                <li><strong>Lost Opportunity:</strong> €32,000 in savings foregone</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="roi-analysis">
                        <div class="roi-title">📊 Consultant Cost Analysis & ROI Calculation</div>
                        <div class="roi-stats">
                            <div class="roi-stat">
                                <div class="roi-number">€246,000</div>
                                <div class="roi-label">Total Consultant Path Investment</div>
                            </div>
                            <div class="roi-stat">
                                <div class="roi-number">€32,000</div>
                                <div class="roi-label">Annual PM Time Savings (50% of junior PM)</div>
                            </div>
                            <div class="roi-stat">
                                <div class="roi-number">7.7 years</div>
                                <div class="roi-label">Consultant ROI Break-Even Time</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="highlight-bottom">
                        🎯 Question: What percentage of the €246,000 consultant alternative represents fair value for an immediate, proven solution?
                    </div>
                </div>
            </div>

            <!-- Slide: Commercial Offer Comparison -->
            <div class="slide">
                <div class="slide-header">
                    <div class="slide-title">Commercial Offer Comparison</div>
                    <div class="slide-subtitle">Ready-to-Deploy Prototype vs External Consultant Development</div>
                </div>
                <div class="slide-content">
                    <div class="commercial-comparison">
                        <div class="proposal-section my-proposal">
                            <div class="proposal-title">🚀 My Prototype (Ready Now)</div>
                            <div class="comparison-stats">
                                <div class="comparison-stat">
                                    <div class="comparison-number">€60,000</div>
                                    <div class="comparison-label">Developer Compensation</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€0</div>
                                    <div class="comparison-label">No internal support needed</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">0 months</div>
                                    <div class="comparison-label">Time to Deployment</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€0</div>
                                    <div class="comparison-label">Lost savings: start immediately</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€60,000</div>
                                    <div class="comparison-label">Total Investment</div>
                                </div>
                            </div>
                            <ul class="component-list">
                                <li><strong>Immediate Deployment:</strong> Prototype ready for production</li>
                                <li><strong>Proven Solution:</strong> 20+ weeks of development already invested</li>
                                <li><strong>Fixed Cost:</strong> No surprises or scope creep</li>
                                <li><strong>Start Saving Immediately:</strong> Begin ROI from day 1</li>
                            </ul>
                        </div>
                        <div class="proposal-section external-proposal">
                            <div class="proposal-title">⏳ External Consultant Alternative</div>
                            <div class="comparison-stats">
                                <div class="comparison-stat">
                                    <div class="comparison-number">€208,000</div>
                                    <div class="comparison-label">Development Cost (6 man-months at €200/hour)</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€6,000</div>
                                    <div class="comparison-label">Internal Support (4 hours/week × 6 months)</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">12 months</div>
                                    <div class="comparison-label">Time to Deployment</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€32,000</div>
                                    <div class="comparison-label">Lost savings: 50% of Junior PM annual salary</div>
                                </div>
                                <div class="comparison-stat">
                                    <div class="comparison-number">€246,000</div>
                                    <div class="comparison-label">Total Cost + Lost Savings (€32k in 12 months)</div>
                                </div>
                            </div>
                            <ul class="component-list">
                                <li><strong>High Development Risk:</strong> Scope creep and timeline delays</li>
                                <li><strong>Internal Resource Drain:</strong> 4 hours/week for 6 months</li>
                                <li><strong>Delayed Value:</strong> 12 months before any savings begin</li>
                                <li><strong>Lost Opportunity:</strong> €32,000 in savings foregone</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="roi-analysis">
                        <div class="roi-title">📊 ROI Analysis & Value Comparison</div>
                        <div class="roi-stats">
                            <div class="roi-stat">
                                <div class="roi-number">€186,000</div>
                                <div class="roi-label">Total Savings vs External Consultant</div>
                            </div>
                            <div class="roi-stat">
                                <div class="roi-number">€32,000</div>
                                <div class="roi-label">Annual PM Time Savings (50% of junior PM)</div>
                            </div>
                            <div class="roi-stat">
                                <div class="roi-number">1.9 months</div>
                                <div class="roi-label">Break-Even Time</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="highlight-bottom">
                        🎯 Strategic advantage: €186k savings + 12 months earlier deployment + immediate ROI vs external consultant approach
                    </div>
                </div>
            </div>

            <!-- Slide: Thank You -->
            <div class="slide thank-you-slide">
                <div class="thank-you-slide-full">
                    <div class="thank-you-content-center">
                        <div class="thank-you-main-title">Thank You</div>
                        <div class="thank-you-subtitle">Ready to Transform Your CPQ Process</div>
                        <div class="thank-you-contact">Questions & Discussion Welcome</div>
                        
                        <div class="thank-you-author">
                            <div class="thank-you-author-name">Giancarlo Cutrignelli</div>
                            <div class="thank-you-author-title">giancarlo.cutrignelli@gmail.com</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="control-btn" onclick="previousSlide()">← Previous</button>
        <button class="control-btn" onclick="nextSlide()">Next →</button>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        // Calculate numbered slides (exclude title and thank you slides)
        function getNumberedSlidesInfo() {
            const allSlides = document.querySelectorAll('.slide');
            const numberedSlides = document.querySelectorAll('.slide:not(.title-slide):not(.thank-you-slide)');
            return {
                total: numberedSlides.length,
                current: getCurrentSlideNumber()
            };
        }

        function getCurrentSlideNumber() {
            const currentSlideElement = slides[currentSlide];
            if (currentSlideElement.classList.contains('title-slide') || 
                currentSlideElement.classList.contains('thank-you-slide')) {
                return 0; // No numbering for title/thank you slides
            }
            
            // Count how many numbered slides come before the current slide
            let count = 0;
            for (let i = 0; i < currentSlide; i++) {
                if (!slides[i].classList.contains('title-slide') && 
                    !slides[i].classList.contains('thank-you-slide')) {
                    count++;
                }
            }
            return count + 1; // +1 because we want 1-based numbering
        }

        function updateSlideCounter() {
            // Remove any existing counters
            const existingCounters = document.querySelectorAll('.slide-counter');
            existingCounters.forEach(counter => counter.remove());
            
            const slideInfo = getNumberedSlidesInfo();
            const currentSlideElement = slides[currentSlide];
            
            // Only add counter to numbered slides (not title or thank you)
            if (!currentSlideElement.classList.contains('title-slide') && 
                !currentSlideElement.classList.contains('thank-you-slide')) {
                
                const counter = document.createElement('div');
                counter.className = 'slide-counter';
                counter.textContent = `${slideInfo.current} / ${slideInfo.total}`;
                currentSlideElement.appendChild(counter);
            }
        }

        // Chat Demo Data - Updated with Complete CPQ Flow
        const chatMessages = [
            { type: 'user', text: 'I need a quote for TechCorp in the industrial market with volumes of 100, 150, 200' },
            { type: 'agent', text: '✅ **Perfect! I\'ve created a new CPQ session for TechCorp in the industrial market.**\n\n## Available Product Families for Industrial Market\n\nHere are the compatible product families for your industrial application:\n\n### **Intel Core Edge Servers**\n- **RECOR-30-11** - Intel Core Edge Server (3 configurations available)\n- **RECOR-40-13** - Intel Core Edge Server (4 configurations available)  \n- **RECOR-44-11** - Intel Core Edge Server (15 configurations available)\n- **RECOR-54-13** - Intel Core Edge Server (4 configurations available)\n\n### **Jetson Edge AI Systems**\n- **RECOR-31-11** - Jetson Edge AI (6 configurations available)\n- **RECOR-33-11** - Jetson Edge AI (7 configurations available)\n\n### **ARM Edge Gateways**\n- **REGATE-10-12** - ARM Edge Gateway (12 configurations available)\n- **REGATE-10-14** - ARM Edge Gateway (6 configurations available)\n- **REGATE-15A-14** - ARM Edge Gateway (8 configurations available)\n\n**Which product family interests you most?** Please let me know the exact family ID (e.g., RECOR-40-13) and I\'ll show you the specific configurations available for your industrial application.' },
            { type: 'user', text: 'Show me hardware options for RECOR-40-13 family' },
            { type: 'agent', text: '✅ **Discovery Operation Complete**\n\nHere are the hardware options available for the RECOR-40-13 product family:\n\n## RECOR-40-13 Hardware Configurations\n\n1. **RECOR-40-13-11-[yy]** - Value Configuration\n   - Intel Core i5 35W processor\n   - 8GB DDR5 RAM\n   - 1x 500GB NVMe storage\n   - Base Price: $1,619.43\n\n2. **RECOR-40-13-13-[yy]** - Mid-range Configuration  \n   - Intel Core i7 35W processor\n   - 32GB DDR5 RAM\n   - 500GB NVMe + 1x 960GB SSD\n   - 4x 1GbE network ports\n   - Base Price: $2,325.99\n\n3. **RECOR-40-13-15-[yy]** - High-end Configuration\n   - Intel Core i9 35W processor\n   - 64GB DDR5 RAM\n   - 500GB NVMe + 1x 1.92TB SSD\n   - 4x 1GbE + 2x 10GbE network ports\n   - Base Price: $3,388.60\n\n4. **RECOR-40-13-[xx]-[yy]** - Custom Configuration\n   - Fully customizable option (configured to your specifications)\n\n**Which configuration would you like to select? Please provide the exact configuration code (e.g., RECOR-40-13-11-[yy])**' },
            { type: 'user', text: 'Select RECOR-40-13-13-[yy] configuration' },
            { type: 'agent', text: '✅ **Configuration Selected Successfully!**\n\nI\'ve selected the **RECOR-40-13-13-[yy]** configuration for your session. This hardware configuration has been successfully added to your CPQ session.\n\n**Next Steps:**\nNow that your hardware is configured, we can proceed to software selection. Would you like me to:\n\n1. **Show compatible software bundles** for your RECOR-40-13-13-[yy] configuration\n2. **See individual software components** available\n3. **Get an auto-recommendation** for the best software package\n\nWhich option would you prefer?' },
            { type: 'user', text: 'Show me compatible software bundles.' },
            { type: 'agent', text: '✅ **Perfect! I found 12 compatible software bundles for your RECOR-40-13 hardware configuration.**\n\nHere are your available software bundle options:\n\n## **Recommended Bundles (Most Popular)**\n1. **UBU-EGE-SEC-IGN-BDL** - Ubuntu + GreenEdge + Cybersecurity + Ignition ($73)\n2. **UBU-ESF-SEC-IGN-BDL** - Ubuntu + ESF Core + Cybersecurity + Ignition ($41)\n3. **UBU-EGE-SEC-BDL** - Ubuntu + GreenEdge + Cybersecurity ($73)\n4. **UBU-ESF-SEC-BDL** - Ubuntu + ESF Core + Cybersecurity ($114)\n\n## **Standard Bundles**\n5. **UBU-EGE-IGN-BDL** - Ubuntu + GreenEdge + Ignition ($0)\n6. **UBU-ESF-IGN-BDL** - Ubuntu + ESF Core + Ignition ($41)\n7. **UBU-EGE-BDL** - Ubuntu + GreenEdge ($0)\n8. **UBU-ESF-BDL** - Ubuntu + ESF Core ($41)\n9. **UBU-IGN-BDL** - Ubuntu + Ignition ($0)\n\n## **Basic Options**\n10. **HW-ONLY** - Hardware only ($0)\n11. **UBU-BDL** - Ubuntu only ($0)\n12. **WIN10-BDL** - Win10 IoT ($0)\n\n**Which software bundle would you like to select?** Please provide the exact bundle code (e.g., \"UBU-EGE-SEC-IGN-BDL\") or let me know if you\'d like more details about any specific bundle.' },
            { type: 'user', text: 'Select UBU-ESF-SEC-IGN-BDL bundle' },
            { type: 'agent', text: '✅ **Bundle Selection Complete!**\n\nI\'ve successfully selected the **UBU-ESF-SEC-IGN-BDL** software bundle for your configuration. This bundle includes:\n\n- **UBU**: Ubuntu Enterprise Support\n- **ESF**: Extended Security Features  \n- **SEC**: Security Compliance Package\n- **IGN**: Ignite Performance Optimization\n- **BDL**: Bundle Discount Structure\n\nYour software configuration is now complete! \n\n**Next Steps:**\nWould you like to:\n1. **Add services** (warranty, support, installation, etc.) to your configuration?\n2. **Proceed directly to validation and pricing** for your complete hardware + software setup?\n\nPlease let me know which option you prefer! 🚀' },
            { type: 'user', text: 'Show me available services.' },
            { type: 'agent', text: '✅ **Available Services for Your Configuration**\n\nI found **14 compatible services** for your RECOR-40-13 hardware configuration. Here are the available options:\n\n## 🔧 **Factory Image Services**\n- **SET-CFI-62443-INSTALL** - Custom Factory Image installation - IEC 62443-4-2 ($12.00/unit)\n- **SET-CFI-NOSEC-INSTALL** - Custom Factory Image installation - No Hardening ($8.00/unit)\n- **SET-SFI-62443-INSTALL** - Standard Factory Image installation - IEC 62443-4-2 (Free)\n- **SET-SFI-NOSEC-INSTALL** - Standard Factory Image installation - No Hardening (Free)\n\n## 🛡️ **Security & Identity Services**\n- **SET-CFI-62443-PREP** - Custom Factory Image preparation - IEC 62443-4-2 ($49,000 one-time)\n- **SET-CFI-NOSEC-PREP** - Custom Factory Image preparation - No Hardening ($25,000 one-time)\n- **SET-CFI-ETH-LDEVID** - Custom Factory Image LDevID installation ($4.00/unit)\n\n## ☁️ **Cloud & Managed Services**\n- **EC-SUB-MS-SNM-PRM** - Premium EC Support & Maintenance (9.6% of EC)\n- **EC-SUB-MS-SETUP-STD** - Standard EC setup fee for Managed services - 40h ($6,000 one-time)\n- **EC-SUB-MS-SETUP-EXT** - Extended EC setup fee for Managed services - 70h ($10,500 one-time)\n\n## 📦 **Warranty Extensions**\n- **SRV-EXT-WTY2** - 2Y total HW warranty from shipment date (5% of unit price)\n- **SRV-EXT-WTY3** - 3Y total HW warranty from shipment date (12% of unit price)\n- **SRV-EXT-WTY5** - 5Y total HW warranty from shipment date (18% of unit price)\n\n---\n\n**Would you like to add any of these services to your configuration?** Please specify the service ID(s) you\'re interested in, or let me know if you\'d like to proceed directly to validation and pricing without adding services.' },
            { type: 'user', text: 'Select SET-CFI-62443-PREP and SET-CFI-62443-INSTALL services.' },
            { type: 'agent', text: '✅ **Services Added Successfully!**\n\nI\'ve successfully added both services to your configuration:\n\n1. **SET-CFI-62443-PREP** - Added to session\n2. **SET-CFI-62443-INSTALL** - Added to session\n\nBoth services have been configured with:\n- **Quantity**: 1 unit each\n- **Duration**: 1 year\n\nYour session is now in the **SOFTWARE_CONFIGURED** phase with services added. Would you like to:\n\n1. **Add more services** - I can show you other compatible services\n2. **Proceed to validation and pricing** - Let\'s validate your complete configuration and generate pricing\n3. **View your current configuration** - See what\'s been selected so far\n\nWhat would you like to do next?' },
            { type: 'user', text: 'Calculate pricing.' },
            { type: 'agent', text: 'I\'ve successfully calculated pricing for your session! Here\'s what was completed:\n\n## ✅ Pricing Calculation Complete\n\n**Session ID:** 1 (TechCorp - Industrial market)\n**Status:** SUCCESS\n\n### Ordering Resolution\n- ✅ 6 items processed successfully\n- ✅ All items assigned ordering codes\n- ✅ No manual intervention required\n\n### Pricing Steps Completed\n1. **Hardware Compound Factors** - Calculated for all 5 years\n2. **Component Prices** - Calculated for all years  \n3. **Hardware Device Pricing** - Calculated for 5 years\n4. **Software/Service Pricing** - Calculated successfully\n\n### Summary\nYour pricing has been successfully calculated with complete ordering code resolution. The system processed all hardware, software, and service components across your 5-year volume projections.\n\n**Next Steps:**\n- Would you like to see a detailed yearly pricing summary?\n- Would you like to generate a formal quote?\n- Would you like to review the business case analysis?\n\nWhat would you like to do next?' },
            { type: 'user', text: 'Show me the business case' },
            { type: 'agent', text: '✅ **Business Case Analysis - Session #1**\n\nHere\'s your comprehensive business case for the RECOR-40-13 industrial edge computing solution:\n\n## 📊 Financial Summary (3-Year Projection)\n- **Total Revenue**: $889,025\n- **Total COGS**: $575,146  \n- **Total Margin**: $313,879\n- **Overall Margin Percentage**: 35.31%\n\n## 📈 Year-by-Year Breakdown\n\n**Year 1 (100 units)**\n- Revenue: $225,543 | Margin: $96,767 (42.9%)\n- Hardware: RECOR-40-13-11-11 devices\n- Software: ESF Core Runtime + Ubuntu Pro + Ignition\n- Services: IEC 62443-4-2 Custom Factory Image\n\n**Year 2 (150 units)**\n- Revenue: $266,485 | Margin: $75,184 (28.2%)\n- Additional 50 units deployed\n\n**Year 3 (200 units)**  \n- Revenue: $360,097 | Margin: $105,028 (29.2%)\n- Additional 50 units deployed\n\n## 💰 Key Profit Drivers\n- **Hardware**: 23.32% margin on RECOR devices\n- **Software**: 95.12% margin on ESF subscriptions\n- **Services**: 100% margin on IEC 62443 compliance services\n- **Ubuntu Pro**: 51.11% margin on runtime licenses\n\n## 🎯 Business Value\nThis configuration provides industrial-grade edge computing with:\n- IEC 62443-4-2 security compliance\n- SCADA integration via Ignition\n- Ubuntu Pro hardened runtime\n- ESF Core Runtime for industrial applications\n\nWould you like me to generate a formal quote document or explore any modifications to this business case?' },
            { type: 'user', text: 'Generate quote' },
            { type: 'agent', text: '✅ **Quote Successfully Generated!**\n\nI\'ve generated your quote for session #1 (TechCorp - Industrial market). Here are the key details:\n\n**Quote Reference:** Q-TechCorp-20250914-0001  \n**Total Revenue:** $889,024.78  \n**Total Items:** 18 line items\n\n**Configuration Summary:**\n- **Hardware:** RECOR-40-13-11-11 (Intel Core i5 35W, 8GB DDR5 RAM, 1x 500GB NVMe)\n- **Software Bundle:** UBU-ESF-SEC-IGN-BDL (Ubuntu Pro + ESF + Ignition)\n- **Services:** IEC 62443-4-2 Custom Factory Image preparation and installation\n\n**Yearly Breakdown:**\n- **Year 1:** $225,542.84 (100 units)\n- **Year 2:** $266,485.12 (150 additional units)  \n- **Year 3:** $360,096.82 (200 additional units)\n- **Years 4-5:** Software subscriptions only ($18,450/year)\n\nThe quote includes all resolved ordering codes and is ready for customer presentation. Would you like me to:\n- Show detailed line items\n- Generate a business case analysis\n- Export the quote in a specific format\n- Make any adjustments to the configuration?' }
        ];

        let demoIndex = 0;
        let isPlaying = false;
        let stepMode = false;

        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');
            updateSlideCounter(); 
        }

        function nextSlide() {
            showSlide(currentSlide + 1);
        }

        function previousSlide() {
            showSlide(currentSlide - 1);
        }

        // Chat demo functions
        function processMarkdown(text) {
            // Process headers first (before any other processing)
            // Use more flexible regex that doesn't require end-of-line match
            let processed = text
                .replace(/^### (.+)$/gm, '<h3>$1</h3>')
                .replace(/^## (.+)$/gm, '<h2>$1</h2>')
                .replace(/^# (.+)$/gm, '<h1>$1</h1>');
            
            // Now process bold/italic (after headers so header content can contain bold)
            processed = processed
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code>$1</code>');
            
            // Process lists
            processed = processed.replace(/^- (.+)$/gm, '<li>$1</li>');
            
            // Wrap consecutive list items in ul tags
            processed = processed.replace(/(<li>.*?<\/li>)(\s*<br>\s*<li>.*?<\/li>)*/gs, function(match) {
                return '<ul>' + match.replace(/<br>\s*/g, '') + '</ul>';
            });
            
            // Convert remaining newlines to br tags (do this last)
            processed = processed.replace(/\n/g, '<br>');
            
            return processed;
        }

        function typewriterAnimation(element, text, speed) {
            return new Promise((resolve) => {
                let index = 0;
                const cursor = document.createElement('span');
                cursor.className = 'typing-cursor';
                cursor.innerHTML = '&nbsp;';
                element.appendChild(cursor);
                
                function typeChar() {
                    if (index < text.length) {
                        const charToAdd = text[index];
                        if (charToAdd === '\n') {
                            element.insertBefore(document.createElement('br'), cursor);
                        } else {
                            element.insertBefore(document.createTextNode(charToAdd), cursor);
                        }
                        index++;
                        
                        // Scroll during typing
                        const messagesContainer = document.getElementById('chatMessages');
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                        
                        setTimeout(typeChar, speed);
                    } else {
                        cursor.remove();
                        resolve();
                    }
                }
                
                typeChar();
            });
        }

        function streamingAnimation(element, text, blockSpeed) {
            return new Promise((resolve) => {
                const processedText = processMarkdown(text);
                
                // Split into words/small blocks for streaming effect
                const words = processedText.split(/(\s+|<[^>]*>)/);
                let index = 0;
                
                function addBlock() {
                    if (index < words.length) {
                        const block = document.createElement('span');
                        block.className = 'streaming-block';
                        block.style.animationDelay = '0ms';
                        block.innerHTML = words[index];
                        element.appendChild(block);
                        
                        index++;
                        setTimeout(addBlock, blockSpeed);
                    } else {
                        resolve();
                    }
                }
                
                addBlock();
            });
        }

        function streamingMarkdownAnimation(element, text, blockSpeed) {
            return new Promise((resolve) => {
                // Split text into sentences/chunks while preserving structure
                const sentences = text.split(/(\.\s+|\n\n)/);
                let currentText = '';
                let index = 0;
                
                function addNextChunk() {
                    if (index < sentences.length) {
                        currentText += sentences[index];
                        
                        // Update the element with processed markdown
                        element.innerHTML = processMarkdown(currentText);
                        
                        // Add streaming cursor
                        const cursor = document.createElement('span');
                        cursor.className = 'typing-cursor';
                        cursor.innerHTML = '&nbsp;';
                        element.appendChild(cursor);
                        
                        // Scroll to show new content
                        const messagesContainer = document.getElementById('chatMessages');
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                        
                        index++;
                        
                        setTimeout(() => {
                            // Remove cursor before adding next chunk
                            const existingCursor = element.querySelector('.typing-cursor');
                            if (existingCursor) existingCursor.remove();
                            addNextChunk();
                        }, blockSpeed);
                    } else {
                        // Final cleanup - remove any remaining cursor
                        const existingCursor = element.querySelector('.typing-cursor');
                        if (existingCursor) existingCursor.remove();
                        
                        // Final render with complete markdown
                        element.innerHTML = processMarkdown(currentText);
                        
                        resolve();
                    }
                }
                
                addNextChunk();
            });
        }

        async function addChatMessage(message, useTypingAnimation = true) {
            const messagesContainer = document.getElementById('chatMessages');
            if (demoIndex === 0) {
                messagesContainer.innerHTML = '';
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${message.type}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = message.type === 'agent' ? 'agent-content' : 'user-content';
            
            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            if (useTypingAnimation) {
                if (message.type === 'user') {
                    await typewriterAnimation(contentDiv, message.text, 25); /* CHANGE THIS TO CONTROL USER TYPING SPEED*/
                } else {
                    await streamingMarkdownAnimation(contentDiv, message.text, 100);
                }
            } else {
                // Instant display
                if (message.type === 'agent') {
                    contentDiv.innerHTML = processMarkdown(message.text);
                } else {
                    contentDiv.innerHTML = message.text.replace(/\n/g, '<br>');
                }
            }
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function clearChat() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '<div class="demo-placeholder">🎬 Click a button below to start the interactive demo</div>';
        }

        function showThinkingIndicator() {
            const messagesContainer = document.getElementById('chatMessages');
            
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'thinking-indicator';
            thinkingDiv.id = 'thinkingIndicator';
            
            const dotsDiv = document.createElement('div');
            dotsDiv.className = 'thinking-dots';
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.className = 'thinking-dot';
                dotsDiv.appendChild(dot);
            }
            
            thinkingDiv.appendChild(dotsDiv);
            messagesContainer.appendChild(thinkingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideThinkingIndicator() {
            const thinkingIndicator = document.getElementById('thinkingIndicator');
            if (thinkingIndicator) {
                thinkingIndicator.remove();
            }
        }

        async function showNextMessage() {
            if (demoIndex >= chatMessages.length) {
                endDemo();
                return;
            }

            const message = chatMessages[demoIndex];
            
            if (message.type === 'user') {
                // Wait for user typing to complete
                await addChatMessage(message, true);
                demoIndex++;
                
                // Only show thinking indicator AFTER user message is complete
                if (stepMode) {
                    setTimeout(async () => {
                        showThinkingIndicator();
                        setTimeout(async () => {
                            hideThinkingIndicator();
                            if (demoIndex < chatMessages.length) {
                                await showNextMessage();
                            }
                        }, 2000);
                    }, 300); // Brief pause after user message
                } else {
                    setTimeout(async () => {
                        showThinkingIndicator();
                        setTimeout(async () => {
                            hideThinkingIndicator();
                            await showNextMessage();
                        }, 2000);
                    }, 300);
                }
            } else {
                // Wait for agent response to complete
                await addChatMessage(message, true);
                demoIndex++;
                
                if (stepMode) {
                    document.getElementById('nextBtn').style.display = demoIndex < chatMessages.length ? 'inline-block' : 'none';
                } else {
                    setTimeout(showNextMessage, 800); // Pause after agent response
                }
            }
        }

        function startAutoDemo() {
            if (isPlaying) return;
            
            isPlaying = true;
            stepMode = false;
            demoIndex = 0;
            
            clearChat();
            document.getElementById('playBtn').classList.add('btn-hidden');
            document.getElementById('stepBtn').classList.add('btn-hidden');
            document.getElementById('nextBtn').classList.add('btn-hidden');
            
            showNextMessage();
        }

        function startStepDemo() {
            if (isPlaying) return;
            
            isPlaying = true;
            stepMode = true;
            demoIndex = 0;
            
            clearChat();
            document.getElementById('playBtn').classList.add('btn-hidden');
            document.getElementById('stepBtn').classList.add('btn-hidden');
            document.getElementById('nextBtn').classList.remove('btn-hidden');
            
            showNextMessage();
        }

        function nextChatStep() {
            if (!stepMode || !isPlaying) return;
            showNextMessage();
        }

        function resetDemo() {
            isPlaying = false;
            stepMode = false;
            demoIndex = 0;
            
            clearChat();
            
            document.getElementById('playBtn').classList.remove('btn-hidden');
            document.getElementById('stepBtn').classList.remove('btn-hidden');
            document.getElementById('nextBtn').classList.add('btn-hidden');
        }

        function endDemo() {
            isPlaying = false;
            
            document.getElementById('playBtn').classList.remove('btn-hidden');
            document.getElementById('stepBtn').classList.remove('btn-hidden');
            document.getElementById('nextBtn').classList.add('btn-hidden');
        }

        // Event listeners
       
        document.getElementById('playBtn').addEventListener('click', startAutoDemo);
        document.getElementById('stepBtn').addEventListener('click', startStepDemo);
        document.getElementById('nextBtn').addEventListener('click', nextChatStep);
        document.getElementById('resetBtn').addEventListener('click', resetDemo);

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') previousSlide();
            if (e.key === 'ArrowRight') nextSlide();
        });

        // Initialize
        showSlide(0);
    </script>
</body>
</html>